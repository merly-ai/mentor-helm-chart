# Merly Mentor Kubernetes Helm Charts

#### Thank you for trying our Helm chart of Mentor

## Usage

### Prerequisites

This is a Helm chart - you need to have Helm installed. For details on how to do that, please visit their website [Helm](https://helm.sh).
Additionally you will need a registration key which you can get through our early access website [Merly] (<https://www.merly.ai/early-access>)

### Setting up a local cluster

You will also need a space to run the helm chart. If you have a working Kubernetes cluster, you can skip these steps and proceed to the step "Adding the Merly Mentor Helm Repository".

For our local testing we used kind - kind is a tool for running local Kubernetes clusters using Docker container "nodes".
Kind does not require `kubectl`, but you will not be able to perform some of tasks with your cluster.
To install `kubectl` see the upstream [kubectl installation docs](https://kubernetes.io/docs/tasks/tools/install-kubectl/).

#### Installation

You can install kind from a package manager, from source or release binaries

##### Installing from a Package manager

On macOS or Linux via Homebrew:

```
brew install kind
```

On macOS via MacPorts:

```
sudo port selfupdate && sudo port install kind
```

On Windows via [Chocolatey](https://chocolatey.org/packages/kind)

```
choco install kind
```

On Windows via [Winget](https://github.com/microsoft/winget-pkgs/tree/master/manifests/k/Kubernetes/kind)

```
winget install Kubernetes.kind
```

##### Installing from Release binaries

Pre-built binaries are available on our [releases page](https://github.com/kubernetes-sigs/kind/releases)

To install, download the binary for your platform from “Assets”, then rename it to kind (or perhaps kind.exe on Windows) and place this into your $PATH at your preferred binary installation directory.

On Linux:

```
# For AMD64 / x86_64
[ $(uname -m) = x86_64 ] && curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.30.0/kind-linux-amd64
# For ARM64
[ $(uname -m) = aarch64 ] && curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.30.0/kind-linux-arm64
chmod +x ./kind
sudo mv ./kind /usr/local/bin/kind
```

On macOS:

```
# For Intel Macs
[ $(uname -m) = x86_64 ] && curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.30.0/kind-darwin-amd64
# For M1 / ARM Macs
[ $(uname -m) = arm64 ] && curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.30.0/kind-darwin-arm64
chmod +x ./kind
mv ./kind /some-dir-in-your-PATH/kind
```

On Windows in [PowerShell](https://en.wikipedia.org/wiki/PowerShell):

```
curl.exe -Lo kind-windows-amd64.exe https://kind.sigs.k8s.io/dl/v0.30.0/kind-windows-amd64
Move-Item .\kind-windows-amd64.exe c:\some-dir-in-your-PATH\kind.exe
```

##### Installing from Source

Instructions can be found [here](https://kind.sigs.k8s.io/docs/user/quick-start/#installing-from-source)

#### Creating a Cluster

Creating a Kubernetes cluster is as simple as `kind create cluster`.

This will bootstrap a Kubernetes cluster using a pre-built [node image](https://kind.sigs.k8s.io/docs/design/node-image).
To specify another image use the `--image` flag - `kind create cluster --image=...`.
Using a different image allows you to change the Kubernetes version of the created cluster.

If you desire to build the node image yourself see the [building images](https://kind.sigs.k8s.io/docs/user/quick-start/#building-images) in the documentation.

By default, the cluster will be given the name `kind`. Use the `--name` flag to assign the cluster a different context name.

More usage can be discovered with `kind create cluster --help`

#### Interacting With Your Cluster

After creating a cluster, you can use kubectl to interact with it by using the [configuration file generated by kind](https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/).

To see all the clusters you have created, you can use the `get clusters` command.

For example, let's say you create two clusters:

```
kind create cluster # Default cluster context name is `kind`.
...
kind create cluster --name kind-2
```

When you list your kind clusters, you will see something like the following:

```
kind get clusters
kind
kind-2
```

In order to interact with a specific cluster, you only need to specify the cluster name as a context in kubectl:

```
kubectl cluster-info --context kind-kind
kubectl cluster-info --context kind-kind-2
```

#### Deleting a Cluster

If you created a cluster with `kind create cluster` then deleting it is equally simple:

```
kind delete cluster
```

If the flag `--name` is not specified, kind will use the default cluster context name `kind` and delete that cluster.

Now that you have gained a handle on how to create and delete clusters we can proceed adding a helm chart to the cluster.

### Adding the Merly Mentor Helm Repository

You can add the `merly-mentor` Helm repository

```bash
helm repo add merly-mentor https://charts.merly-mentor.ai
```

Then look for available charts

```bash
helm search repo merly-mentor
```

And finally install the chart with a release name `mentor` (but really could be anything you prefer):

```bash
helm install my-release merly-mentor/merly-mentor --set global.registrationKey="<replace-with-your-product-key>"
```

The alternative is to download or git clone the repository and manually install the chart

```bash
helm install mentor ./ --set global.registrationKey="<replace-with-your-product-key>"
```

The only caveat is you need to be in the right folder `charts/merly-mentor`

## Uninstalling the Chart

To uninstall/delete the `my-release` deployment:

```bash
helm uninstall my-release
```

The command removes all the Kubernetes components associated with the chart and deletes the release.

The code is offered as-is without any guarantees.
<!-- 
## Configuration
| Parameter                                        | Description                                         | Default                          |
|--------------------------------------------------|-----------------------------------------------------|----------------------------------|
| `nameOverride`                                   | Override the chart name                             | `""`                             |
| `global.registrationKey`                         | Registration key for global settings                | `''`                             |
| `global.persistence.storageClass`                | Storage class for persistent volume (optional)      | `"default"`                      |
| `global.persistence.size`                        | Size of the persistent volume (optional)            | `"4Gi"`                          |
| `global.persistence.pvcNameOverride`             | PVC name override for persistence (optional)        | `"merly-mentor-pvc"`             |
| `bridge.replicaCount`                            | Number of replicas for the bridge service (optional)| `1`                              |
| `bridge.nameOverride`                            | Override the name for bridge service (optional)     | `"merly-bridge"`                 |
| `bridge.image.repository`                        | Repository for the bridge image                     | `merlyai/bridge`                 |
| `bridge.image.tag`                               | Tag for the bridge image                            | `v0.7.2`                         |
| `bridge.containerPort`                           | Container port for the bridge service (default)     | `8080`                           |
| `mentor.nameOverride`                            | Override the name for mentor service (optional)     | `"merly-mentor"`                 |
| `mentor.replicaCount`                            | Number of replicas for the mentor service           | `1`                              |
| `mentor.image.repository`                        | Repository for the mentor image                     | `merlyai/daemon`                 |
| `mentor.image.tag`                               | Tag for the mentor image                            | `v0.7.6`                         |
| `mentor.containerPort`                           | Container port for the mentor service               | `4200`                           |
| `merlyUi.replicaCount`                           | Number of replicas for the UI service               | `1`                              |
| `merlyUi.nameOverride`                           | Override the name for UI service (optional)         | `"merly-ui"`                     |
| `merlyUi.image.repository`                       | Repository for the UI image                         | `merlyai/ui`                     |
| `merlyUi.image.tag`                              | Tag for the UI image                                | `v0.7.2`                         |
| `merlyUi.containerPort`                          | Container port for the UI service                   | `3000`                           |
| `ingress.enabled`                                | Enable or disable ingress                           | `false`                          |
| `ingress.className`                              | Class name for ingress                              | `""`                             |
| `ingress.annotations`                            | Annotations for ingress                             | `{}`                             |
| `ingress.hosts[0].host`                          | Host for ingress                                    | `chart-example.local`            |
| `ingress.hosts[0].paths[0].path`                 | Path for ingress                                    | `/`                              |
| `ingress.hosts[0].paths[0].pathType`             | Path type for ingress                               | `ImplementationSpecific`         |
| `ingress.tls[0].secretName`                      | TLS secret name for ingress                         | `merly-tls`                      |
| `ingress.tls[0].hosts[0]`                        | TLS hosts for ingress                               | `merly.local`                    |
 -->
